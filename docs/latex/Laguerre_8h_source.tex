\doxysection{Laguerre.\+h}
\hypertarget{Laguerre_8h_source}{}\label{Laguerre_8h_source}\index{headers/Laguerre.h@{headers/Laguerre.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Александр,\ Дмитрий}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifndef\ LAGUERRE}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ LAGUERRE}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <numbers>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <complex>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}BaseSolver.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}ExtendedFunctions.h"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }Laguerre\{}
\DoxyCodeLine{00017\ \textcolor{keyword}{using\ }std::complex;}
\DoxyCodeLine{00018\ \textcolor{keyword}{using\ }std::vector;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00021\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classLaguerre_1_1Original}{Original}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classBaseSolver}{BaseSolver}}<T>\{}
\DoxyCodeLine{00022\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ T\ eps\ \ \ =\ std::numeric\_limits<T>::epsilon();}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ laguer(\textcolor{keyword}{const}\ std::vector<std::complex<T>>\&\ a,\ std::complex<T>\&\ x,\ \textcolor{keywordtype}{int}\&\ converged,\ \textcolor{keywordtype}{int}\ itmax)\{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ converged\ =\ 1;}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ std::complex<T>\ dx,\ x1,\ b,\ d,\ f,\ g,\ h,\ sq,\ gp,\ gm,\ g2;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ T\ err,\ abx,\ abp,\ abm;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\ =\ a.size()\ -\/\ 1;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ iter\ =\ 1;\ iter\ <=\ itmax;\ iter++)\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ std::complex<T>(1.0,\ 0.0);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ err\ =\ std::abs(b);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ f\ =\ std::complex<T>(0.0,\ 0.0);}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ abx\ =\ std::abs(x);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ m\ -\/\ 1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ f\ =\ fma(x,\ f,\ d);}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ fma(x,\ d,\ b);}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ fma(x,\ b,\ a[j]);}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ err\ =\ fma(err,\ abx,\ std::abs(b));}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(b)\ <=\ err\ *\ eps)}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ We\ are\ on\ the\ root.}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ g\ =\ d\ /\ b;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ g2\ =\ g\ *\ g;}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ h\ =\ fma(f\ /\ b,\ -\/\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(2),\ g2);}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ sq\ =\ std::sqrt(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(m\ -\/\ 1)\ *\ (fma(h,\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(m),\ -\/g2)));}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ gp\ =\ g\ +\ sq;}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ gm\ =\ g\ -\/\ sq;}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ abp\ =\ std::abs(gp);}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ abm\ =\ std::abs(gm);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ gp\ =\ abp\ <\ abm\ ?\ gm\ :\ gp;}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ dx\ =\ (std::max(abp,\ abm)\ >\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0.0))\ ?\ (\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(m)\ /\ gp)\ :\ std::polar(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(1)\ +\ abx,\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(iter));}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ x1\ =\ x\ -\/\ dx;}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ ==\ x1)}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ Converged.}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ x1;\ \ \ \ \ \ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ converged\ =\ -\/1;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ throw\ "{}Too\ many\ iterations!"{};}}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{classLaguerre_1_1Original}{Original}}()\{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ }}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLaguerre_1_1Original_a03169c891eccb0b2af5be5e274a25770}{operator()}}(std::vector<T>\&\ poly,\ std::vector<std::complex<T>>\&\ roots,\ std::vector<int>\&\ conv,\ \textcolor{keywordtype}{int}\ itmax=80)\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ std::complex<T>\ x,\ \_b,\ \_c;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\ =\ poly.size()\ -\/\ 1;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}M\ SIZE\ "{}\ <<\ m\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ std::vector<std::complex<T>>\ ad(m\ +\ 1);}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ of\ coefficients\ for\ successive\ deflation.}}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <=\ m;\ i++)}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ ad[i]\ =\ poly[i];}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ std::vector<std::complex<T>>\ ad\_v;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ m\ -\/\ 1;\ j\ >\ 0;\ -\/-\/j)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}j:"{}\ <<\ j\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ std::complex<T>(0.0,\ 0.0);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ at\ zero\ to\ favor\ convergence\ to\ the\ smallest\ remaining\ root.}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ ad\_v\ =\ std::vector<std::complex<T>>(ad.cbegin(),\ ad.cbegin()\ +\ j\ +\ 2);}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ laguer(ad\_v,\ x,\ conv[j],\ itmax);}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ x.imag(std::abs(imag(x))\ <=\ std::abs(real(x))\ *\ eps\ ?\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0)\ :\ x.imag());}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ roots[j]\ =\ x;}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \_b\ =\ ad[j\ +\ 1];}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;\ jj\ >=\ 0;\ jj-\/-\/)\ \{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_c\ =\ ad[jj];}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ad[jj]\ =\ \_b;}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_b\ =\ fma(x,\ \_b,\ \_c);}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ roots[0]\ =\ -\/ad[0];}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ conv[0]\ =\ conv[1];}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Polishing}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (anycomplex(roots))\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}has\ complex!\(\backslash\)n"{}};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 1;\ j\ <\ m;\ ++j)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ roots[j];}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ j\ -\/\ 1;\ i>=0;\ -\/-\/i)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (real(roots[i])\ <=\ real(x))}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[i\ +\ 1]\ =\ roots[i];}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[i\ +\ 1]\ =\ x;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}SOLVED\ EVERYTHING\(\backslash\)n"{};}}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \};}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \};}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
