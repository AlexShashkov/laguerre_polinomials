\doxysection{L18\+\_\+or.\+h}
\hypertarget{L18__or_8h_source}{}\label{L18__or_8h_source}\index{headers/L18\_or.h@{headers/L18\_or.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <complex>}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}ExtendedFunctions.h"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ eps\ =\ std::numeric\_limits<double>::epsilon();}
\DoxyCodeLine{00011\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ big\ =\ std::numeric\_limits<double>::max();}
\DoxyCodeLine{00012\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ small\ =\ std::numeric\_limits<double>::min();}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00023\ \textcolor{keywordtype}{double}\ cross(std::vector<int>\&\ h,\ std::vector<double>\&\ a,\ \textcolor{keywordtype}{int}\ c,\ \textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ determinant}}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ h\_c\ =\ h[c];}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ h\_c1\ =\ h[c-\/1];}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ a\_hc\ =\ a[h\_c1];}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ det\ =\ Laguerre::fms(a[i]-\/a\_hc,\ (\textcolor{keywordtype}{double})(h\_c-\/h\_c1),\ a[h\_c]-\/a\_hc,\ (\textcolor{keywordtype}{double})(i-\/h\_c1));}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ det;}
\DoxyCodeLine{00030\ \ \ \ \ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00040\ \textcolor{keywordtype}{void}\ conv\_hull(\textcolor{keywordtype}{int}\ n,\ std::vector<double>\&\ a,\ std::vector<int>\&\ h,\ \textcolor{keywordtype}{int}\&\ c)\ \{}
\DoxyCodeLine{00041\ \ \ \ \ c\ =\ 0;}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ n\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (c\ >=\ 2\ \&\&\ cross(h,\ a,\ c,\ i)\ <\ eps)}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ c-\/-\/;}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ c++;}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ h[c]\ =\ i;}
\DoxyCodeLine{00048\ \ \ \ \ \}}
\DoxyCodeLine{00049\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00060\ \textcolor{keywordtype}{void}\ estimates(std::vector<double>\&\ alpha,\ \textcolor{keywordtype}{int}\ deg,\ std::vector<std::complex<double>>\&\ roots,\ std::vector<int>\&\ conv,\ \textcolor{keywordtype}{int}\&\ nz)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{int}\ c,\ i,\ j,\ k,\ nzeros;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{double}\ a1,\ a2,\ ang,\ r,\ th;}
\DoxyCodeLine{00063\ \ \ \ \ std::vector<int>\ h(deg\ +\ 1);}
\DoxyCodeLine{00064\ \ \ \ \ std::vector<double>\ a(deg\ +\ 1);}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pi2\ =\ 6.2831853071795865;}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ sigma\ =\ 0.7;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{//\ Log\ of\ absolute\ value\ of\ coefficients}}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ deg\ +\ 1;\ i++)\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha[i]\ >\ 0)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ a[i]\ =\ log(alpha[i]);}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ a[i]\ =\ -\/1E+30;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ \ \ \ \ conv\_hull(deg\ +\ 1,\ a,\ h,\ c);}
\DoxyCodeLine{00077\ \ \ \ \ k\ =\ 0;}
\DoxyCodeLine{00078\ \ \ \ \ th\ =\ pi2\ /\ deg;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//\ Initial\ Estimates}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ c\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ nzeros\ =\ h[i]\ -\/\ h[i\ +\ 1];}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ a1\ =\ pow(alpha[h[i\ +\ 1]],\ 1.0\ /\ nzeros);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ a2\ =\ pow(alpha[h[i]],\ 1.0\ /\ nzeros);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (a1\ <=\ a2\ *\ small)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ r\ is\ too\ small}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ 0.0;}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ nz\ +=\ nzeros;}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ k;\ j\ <\ k\ +\ nzeros;\ j++)}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conv[j]\ =\ -\/1;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ k;\ j\ <\ k\ +\ nzeros;\ j++)}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[j]\ =\ \{0.0,\ 0.0\};}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (a1\ >=\ a2\ *\ big)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ r\ is\ too\ big}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ big;}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ nz\ +=\ nzeros;}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ k;\ j\ <\ k\ +\ nzeros;\ j++)}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conv[j]\ =\ -\/1;}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ ang\ =\ pi2\ /\ nzeros;}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ nzeros;\ j++)}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[k\ +\ j]\ =\ r\ *\ std::complex<double>(cos(ang\ *\ j\ +\ th\ *\ h[i]\ +\ sigma),\ sin(ang\ *\ j\ +\ th\ *\ h[i]\ +\ sigma));}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ r\ is\ just\ right}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ a1\ /\ a2;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ ang\ =\ pi2\ /\ nzeros;}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ nzeros;\ j++)}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[k\ +\ j]\ =\ r\ *\ std::complex<double>(cos(ang\ *\ j\ +\ th\ *\ h[i]\ +\ sigma),\ sin(ang\ *\ j\ +\ th\ *\ h[i]\ +\ sigma));}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ k\ +=\ nzeros;}
\DoxyCodeLine{00111\ \ \ \ \ \}}
\DoxyCodeLine{00112\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00120\ \textcolor{keywordtype}{bool}\ check\_nan\_inf(std::complex<double>\ a)\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordtype}{double}\ re\_a\ =\ real(a);}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{double}\ im\_a\ =\ imag(a);}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keywordflow}{return}\ std::isnan(re\_a)\ ||\ std::isnan(im\_a)\ ||\ (abs(re\_a)\ >\ big)\ ||\ (abs(im\_a)\ >\ big);}
\DoxyCodeLine{00124\ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00140\ \textcolor{keywordtype}{void}\ rcheck\_lag(std::vector<double>\&\ p,\ std::vector<double>\&\ alpha,\ \textcolor{keywordtype}{int}\ deg,\ std::complex<double>\&\ b,\ std::complex<double>\&\ c,\ std::complex<double>\ z,\ \textcolor{keywordtype}{double}\ r,\ \textcolor{keywordtype}{int}\&\ conv,\ \textcolor{keywordtype}{double}\&\ berr,\ \textcolor{keywordtype}{double}\&\ cond)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordtype}{int}\ k;}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordtype}{double}\ rr;}
\DoxyCodeLine{00143\ \ \ \ \ std::complex<double>\ a,\ zz;}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ Evaluate\ polynomial\ and\ derivatives}}
\DoxyCodeLine{00146\ \ \ \ \ zz\ =\ 1.0\ /\ z;}
\DoxyCodeLine{00147\ \ \ \ \ rr\ =\ 1.0\ /\ r;}
\DoxyCodeLine{00148\ \ \ \ \ a\ =\ p[0];}
\DoxyCodeLine{00149\ \ \ \ \ b\ =\ 0.0;}
\DoxyCodeLine{00150\ \ \ \ \ c\ =\ 0.0;}
\DoxyCodeLine{00151\ \ \ \ \ berr\ =\ alpha[0];}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 1;\ k\ <\ deg\ +\ 1;\ k++)\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ c\ =\ zz\ *\ c\ +\ b;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ b\ =\ zz\ *\ b\ +\ a;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ a\ =\ zz\ *\ a\ +\ p[k];}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ berr\ =\ rr\ *\ berr\ +\ alpha[k];}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{comment}{//\ Laguerre\ correction/\ backward\ error\ and\ condition}}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(a)\ >\ eps\ *\ berr)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ b\ =\ b\ /\ a;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ c\ =\ 2.0\ *\ (c\ /\ a);}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ c\ =\ pow(zz,\ 2)\ *\ ((double)deg\ -\/\ 2.0\ *\ zz\ *\ b\ +\ pow(zz,\ 2)\ *\ (pow(b,\ 2)\ -\/\ c));}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ b\ =\ zz\ *\ ((double)deg\ -\/\ zz\ *\ b);}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (check\_nan\_inf(b)\ ||\ check\_nan\_inf(c))}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ conv\ =\ -\/1;}
\DoxyCodeLine{00169\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ cond\ =\ berr\ /\ abs((\textcolor{keywordtype}{double})deg\ *\ a\ -\/\ zz\ *\ b);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ berr\ =\ abs(a)\ /\ berr;}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ conv\ =\ 1;}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00190\ \textcolor{keywordtype}{void}\ check\_lag(std::vector<double>\&\ p,\ std::vector<double>\&\ alpha,\ \textcolor{keywordtype}{int}\ deg,\ std::complex<double>\&\ b,\ std::complex<double>\&\ c,\ std::complex<double>\ z,\ \textcolor{keywordtype}{double}\ r,\ \textcolor{keywordtype}{int}\&\ conv,\ \textcolor{keywordtype}{double}\&\ berr,\ \textcolor{keywordtype}{double}\&\ cond)\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordtype}{int}\ k;}
\DoxyCodeLine{00192\ \ \ \ \ std::complex<double>\ a;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{comment}{//\ Evaluate\ polynomial\ and\ derivatives}}
\DoxyCodeLine{00195\ \ \ \ \ a\ =\ p[deg];}
\DoxyCodeLine{00196\ \ \ \ \ b\ =\ 0.0;}
\DoxyCodeLine{00197\ \ \ \ \ c\ =\ 0.0;}
\DoxyCodeLine{00198\ \ \ \ \ berr\ =\ alpha[deg];}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ deg\ -\/\ 1;\ k\ >=\ 0;\ k-\/-\/)\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ c\ =\ z\ *\ c\ +\ b;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ b\ =\ z\ *\ b\ +\ a;}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ a\ =\ z\ *\ a\ +\ p[k];}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ berr\ =\ r\ *\ berr\ +\ alpha[k];}
\DoxyCodeLine{00205\ \ \ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//\ Laguerre\ correction/\ backward\ error\ and\ condition}}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(a)\ >\ eps\ *\ berr)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ b\ =\ b\ /\ a;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ c\ =\ pow(b,\ 2)\ -\/\ 2.0\ *\ (c\ /\ a);}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (check\_nan\_inf(b)\ ||\ check\_nan\_inf(c))}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ conv\ =\ -\/1;}
\DoxyCodeLine{00214\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ cond\ =\ berr\ /\ (r\ *\ abs(b));}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ berr\ =\ abs(a)\ /\ berr;}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ conv\ =\ 1;}
\DoxyCodeLine{00218\ \ \ \ \ \}}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00231\ \textcolor{keywordtype}{void}\ modify\_lag(\textcolor{keywordtype}{int}\ deg,\ std::complex<double>\&\ b,\ std::complex<double>\&\ c,\ std::complex<double>\ z,\ \textcolor{keywordtype}{int}\ j,\ std::vector<std::complex<double>>\&\ roots)\ \{}
\DoxyCodeLine{00232\ \ \ \ \ std::complex<double>\ t;}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{comment}{//\ Aberth\ correction\ terms}}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ j\ -\/\ 1;\ k++)\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ t\ =\ 1.0\ /\ (z\ -\/\ roots[k]);}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ b\ =\ b\ -\/\ t;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ c\ =\ c\ -\/\ pow(t,\ 2);}
\DoxyCodeLine{00239\ \ \ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ j\ +\ 1;\ k\ <=\ deg;\ k++)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ t\ =\ 1.0\ /\ (z\ -\/\ roots[k]);}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ b\ =\ b\ -\/\ t;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ c\ =\ c\ -\/\ pow(t,\ 2);}
\DoxyCodeLine{00245\ \ \ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{comment}{//\ Laguerre\ correction}}
\DoxyCodeLine{00248\ \ \ \ \ t\ =\ sqrt(}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})(deg\ -\/\ 1)\ *\ (}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})deg\ *\ c\ -\/\ pow(b,\ 2)}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00252\ \ \ \ \ );}
\DoxyCodeLine{00253\ \ \ \ \ c\ =\ b\ +\ t;}
\DoxyCodeLine{00254\ \ \ \ \ b\ =\ b\ -\/\ t;}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(b)\ >\ abs(c))\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ c\ =\ (double)deg\ /\ b;}
\DoxyCodeLine{00258\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ c\ =\ (double)deg\ /\ c;}
\DoxyCodeLine{00260\ \ \ \ \ \}}
\DoxyCodeLine{00261\ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00274\ \textcolor{keywordtype}{void}\ laguerre(std::vector<double>\&\ poly,\ \textcolor{keywordtype}{int}\ deg,\ std::vector<std::complex<double>>\&\ roots,\ std::vector<int>\&\ conv,\ \textcolor{keywordtype}{int}\ itmax)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordtype}{int}\ i,\ j,\ nz;}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{keywordtype}{double}\ r;}
\DoxyCodeLine{00277\ \ \ \ \ std::vector<double>\ berr(deg);\ \textcolor{comment}{//\ Vector\ to\ store\ the\ backward\ errors.}}
\DoxyCodeLine{00278\ \ \ \ \ std::vector<double>\ cond(deg);\ \textcolor{comment}{//\ Vector\ to\ store\ the\ condition\ numbers.}}
\DoxyCodeLine{00279\ \ \ \ \ std::vector<double>\ alpha(deg\ +\ 1);}
\DoxyCodeLine{00280\ \ \ \ \ std::complex<double>\ b,\ c,\ z;}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{comment}{//\ Precheck}}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <=\ deg;\ i++)}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ alpha[i]\ =\ abs(poly[i]);}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha[deg]\ <\ small)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Warning:\ leading\ coefficient\ too\ small."{}}\ <<\ std::endl;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00289\ \ \ \ \ \}\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ \ \ \ else\ if\ (deg\ ==\ 1)\ \{}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ \ \ \ \ \ \ \ roots[0]\ =\ -\/poly[0]\ /\ poly[1];}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ \ \ \ \ \ conv[0]\ =\ 1;}}
\DoxyCodeLine{00294\ \textcolor{comment}{\ \ \ \ \ \ \ \ berr[0]\ =\ 0.0;}}
\DoxyCodeLine{00295\ \textcolor{comment}{\ \ \ \ \ \ \ \ cond[0]\ =\ (alpha[0]\ +\ alpha[1]\ *\ abs(roots[0]))\ /\ (abs(roots[0])\ *\ alpha[1]);}}
\DoxyCodeLine{00296\ \textcolor{comment}{\ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{00297\ \textcolor{comment}{\ \ \ \ \}\ else\ if\ (deg\ ==\ 2)\ \{}}
\DoxyCodeLine{00298\ \textcolor{comment}{\ \ \ \ \ \ \ \ b\ =\ -\/poly[1]\ /\ (2.0\ *\ poly[2]);}}
\DoxyCodeLine{00299\ \textcolor{comment}{\ \ \ \ \ \ \ \ c\ =\ sqrt(pow(poly[1],\ 2)\ -\/\ 4.0\ *\ poly[2]\ *\ poly[0])\ /\ (2.0\ *\ poly[2]);}}
\DoxyCodeLine{00300\ \textcolor{comment}{\ \ \ \ \ \ \ \ roots[0]\ =\ b\ -\/\ c;}}
\DoxyCodeLine{00301\ \textcolor{comment}{\ \ \ \ \ \ \ \ roots[1]\ =\ b\ +\ c;}}
\DoxyCodeLine{00302\ \textcolor{comment}{\ \ \ \ \ \ \ \ conv[0]\ =\ 1;}}
\DoxyCodeLine{00303\ \textcolor{comment}{\ \ \ \ \ \ \ \ conv[1]\ =\ 1;}}
\DoxyCodeLine{00304\ \textcolor{comment}{\ \ \ \ \ \ \ \ berr[0]\ =\ 0.0;}}
\DoxyCodeLine{00305\ \textcolor{comment}{\ \ \ \ \ \ \ \ berr[1]\ =\ 0.0;}}
\DoxyCodeLine{00306\ \textcolor{comment}{\ \ \ \ \ \ \ \ cond[0]\ =\ (alpha[0]\ +\ alpha[1]\ *\ abs(roots[0])\ +\ alpha[2]\ *\ pow(abs(roots[0]),\ 2))\ /\ (abs(roots[0])\ *\ abs(poly[1]\ +\ 2.0\ *\ poly[2]\ *\ roots[0]));}}
\DoxyCodeLine{00307\ \textcolor{comment}{\ \ \ \ \ \ \ \ cond[1]\ =\ (alpha[0]\ +\ alpha[1]\ *\ abs(roots[1])\ +\ alpha[2]\ *\ pow(abs(roots[1]),\ 2))\ /\ (abs(roots[1])\ *\ abs(poly[1]\ +\ 2.0\ *\ poly[2]\ *\ roots[1]));}}
\DoxyCodeLine{00308\ \textcolor{comment}{\ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{00309\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{comment}{//\ Initial\ estimates}}
\DoxyCodeLine{00312\ \ \ \ \ conv.assign(deg,\ 0);}
\DoxyCodeLine{00313\ \ \ \ \ nz\ =\ 0;}
\DoxyCodeLine{00314\ \ \ \ \ estimates(alpha,\ deg,\ roots,\ conv,\ nz);}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{comment}{//\ Main\ loop}}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 1;\ i\ <=\ deg\ +\ 1;\ i++)}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ alpha[i\ -\/\ 1]\ =\ alpha[i\ -\/\ 1]\ *\ (3.8\ *\ (i\ -\/\ 1)\ +\ 1);}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 1;\ i\ <=\ itmax;\ i++)\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ deg;\ j++)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (conv[j]\ ==\ 0)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ roots[j];}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ abs(z);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ >\ 1.0)\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ rcheck\_lag(poly,\ alpha,\ deg,\ b,\ c,\ z,\ r,\ conv[j],\ berr[j],\ cond[j]);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ check\_lag(poly,\ alpha,\ deg,\ b,\ c,\ z,\ r,\ conv[j],\ berr[j],\ cond[j]);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (conv[j]\ ==\ 0)\ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ modify\_lag(deg,\ b,\ c,\ z,\ j,\ roots);}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[j]\ =\ roots[j]\ -\/\ c;}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nz++;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nz\ ==\ deg)}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{goto}\ label10;}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00341\ \ \ \ \ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{comment}{//\ Final\ check}}
\DoxyCodeLine{00344\ \ \ \ \ label10:}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{if}\ (*std::min\_element(conv.begin(),\ conv.end())\ ==\ 1)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00347\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Display\ a\ warning}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Some\ root\ approximations\ did\ not\ converge\ or\ experienced\ overflow/underflow."{}}\ <<\ std::endl;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ backward\ error\ and\ condition\ number\ for\ roots\ that\ did\ not\ converge.}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Note\ that\ this\ may\ produce\ overflow/underflow.}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ deg;\ j++)\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (conv[j]\ !=\ 1)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ roots[j];}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ abs(z);}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ >\ 1.0)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z\ =\ 1.0\ /\ z;}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ 1.0\ /\ r;}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ 0.0;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ poly[0];}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ alpha[0];}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 1;\ i\ <\ deg\ +\ 1;\ i++)\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}sob\ sob\ "{}\ <<\ i\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ z\ *\ c\ +\ b;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ z\ *\ b\ +\ poly[i];}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ r\ *\ berr[j]\ +\ alpha[i];}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cond[j]\ =\ berr[j]\ /\ abs((\textcolor{keywordtype}{double})deg\ *\ b\ -\/\ z\ *\ c);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ abs(b)\ /\ berr[j];}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ 0.0;}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ poly[deg];}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ alpha[deg];}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ deg\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ std::cout\ <<\ "{}hiiiii\ :3\ "{}\ <<\ i\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c\ =\ z\ *\ c\ +\ b;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ z\ *\ b\ +\ poly[i];}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ r\ *\ berr[j]\ +\ alpha[i];}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cond[j]\ =\ berr[j]\ /\ (r\ *\ abs(c));}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ berr[j]\ =\ abs(b)\ /\ berr[j];}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \ \ \}}
\DoxyCodeLine{00392\ \}}

\end{DoxyCode}
