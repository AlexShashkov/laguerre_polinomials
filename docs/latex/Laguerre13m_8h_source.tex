\doxysection{Laguerre13m.\+h}
\hypertarget{Laguerre13m_8h_source}{}\label{Laguerre13m_8h_source}\index{headers/Laguerre13m.h@{headers/Laguerre13m.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Александр,\ Дмитрий}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifndef\ LAGUERRE13}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ LAGUERRE13}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <numbers>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <complex>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ "{}BaseSolver.h"{}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}ExtendedFunctions.h"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }Laguerre\{}
\DoxyCodeLine{00017\ \textcolor{keyword}{using\ }std::complex;}
\DoxyCodeLine{00018\ \textcolor{keyword}{using\ }std::vector;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00021\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classLaguerre_1_1ModifiedLaguerre13}{ModifiedLaguerre13}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classBaseSolver}{BaseSolver}}<T>\{}
\DoxyCodeLine{00022\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ T\ eps\ \ \ =\ std::numeric\_limits<T>::epsilon();}
\DoxyCodeLine{00025\ \ \ \ \ }
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00032\ \ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ laguer13(\textcolor{keyword}{const}\ std::vector<std::complex<T>>\&\ a,\ std::complex<T>\&\ x,\ \textcolor{keywordtype}{int}\&\ lam)\{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ std::complex<T>\ dx,\ x1,\ b,\ d,\ f,\ g,\ h,\ sq,\ gp,\ gm,\ g2;}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ T\ err,\ abx,\ abp,\ abm;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\ =\ a.size()\ -\/\ 1;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ b\ =\ std::complex<T>(1.0,\ 0.0);}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ err\ =\ std::abs(b);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ d\ =\ f\ =\ std::complex<T>(0.0,\ 0.0);}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ abx\ =\ std::abs(x);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ m\ -\/\ 1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ f\ =\ fma(x,\ f,\ d);}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ fma(x,\ d,\ b);}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ b\ =\ fma(x,\ b,\ a[j]);}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ err\ =\ fma(err,\ abx,\ std::abs(b));}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(b)\ <=\ err\ *\ eps)}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \ \textcolor{comment}{//\ We\ are\ on\ the\ root.}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ g\ =\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(lam)*\ b\ /\ d;\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ h\ =\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(2)*f\ /\ d;}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ sq\ =\ std::sqrt(fma(-\/g,\ h,\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(lam\ -\/\ 1)));}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ dx\ =\ g/std::abs(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(1)\ +\ sq);\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ x\ -\/=\ dx;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};\ \ }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00059\ \ \ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{classLaguerre_1_1ModifiedLaguerre13}{ModifiedLaguerre13}}()\{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ }}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00074\ \ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLaguerre_1_1ModifiedLaguerre13_acb5ef79928961737d263676845c885a8}{operator()}}(std::vector<T>\&\ poly,\ std::vector<std::complex<T>>\&\ roots,\ std::vector<int>\&\ conv,\ \textcolor{keywordtype}{int}\ itmax=80)\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ std::complex<T>\ x,\ \_b,\ \_c;}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m\ =\ poly.size()\ -\/\ 1;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ std::vector<std::complex<T>>\ ad(m\ +\ 1);}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ std::vector<std::complex<T>>\ ad\_v;}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lambda;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ m1;}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ of\ coefficients\ for\ successive\ deflation.}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <=\ m;\ i++)}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ ad[i]\ =\ poly[i];}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ diff\ =\ Laguerre::diff(poly,\ 1);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ std::vector<T>\ remainder;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ Laguerre::getRemainder(poly,\ diff,\ remainder);}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ zeros\ =\ std::all\_of(remainder.begin(),\ remainder.end(),\ [](\textcolor{keywordtype}{int}\ i)\ \{\ return\ i==0;\ \});}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (zeros)}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ lambda\ =\ 2*m;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ m1\ =\ 1;}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<T>\ remainder1;}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ Laguerre::getRemainder(diff,\ remainder,\ remainder1);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ zeros\ =\ std::all\_of(remainder1.begin(),\ remainder1.end(),\ [](\textcolor{keywordtype}{int}\ i)\ \{\ return\ i==0;\ \});}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (zeros)\{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m1\ =\ m\ -\/\ remainder.size()\ +\ 1;}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lambda\ =\ 2*m/m1;}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ j\ =\ m\ -\/\ 1;}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ m1;\ ++i)\{}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ x\ =\ std::complex<T>(0.0,\ 0.0);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ at\ zero\ to\ favor\ convergence\ to\ the\ smallest\ remaining\ root.}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ ad\_v\ =\ std::vector<std::complex<T>>(ad.cbegin(),\ ad.cbegin()\ +\ j\ +\ 2);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ laguer13(ad\_v,\ x,\ lambda);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (std::abs(imag(x))\ <=\ std::abs(real(x))\ *\ eps)}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x.imag(\textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}(0));}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ lambda/2;\ ++k)\{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ roots[j]\ =\ x;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ conv[j]\ =\ 1;}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_b\ =\ ad[j\ +\ 1];}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ jj\ =\ j;\ jj\ >=\ 0;\ jj-\/-\/)\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_c\ =\ ad[jj];}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ad[jj]\ =\ \_b;}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_b\ =\ fma(x,\ \_b,\ \_c);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/j;\ \ \ \ }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \ \ \ \ }
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \};}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \};}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
